{% extends "base.html" %}
{% block title %}홈 - 별내위키{% endblock %}
{% block content %}
<h2>홈</h2>
<div style="display:flex;gap:18px">
  <div style="flex:1;max-width:300px">
    <div class="card">
      <h4>목차</h4>
      {% macro node(n, depth=0) -%}
        <ul style="margin-left:{{depth*12}}px">
          <li><a href="{{ url_for('view_document', doc_id=n.id) }}">{{ n.title }}</a></li>
          {%- for c in n.children.order_by(doc_model.created_at.desc()).all() %}
            {{ node(c, depth+1) }}
          {%- endfor %}
        </ul>
      {%- endmacro %}
      {% for r in roots %} {{ node(r,0) }} {% else %}<p>문서가 없습니다.</p>{% endfor %}
    </div>
  </div>
  <div style="flex:2">
    <div class="card">
      <h3>문서 목록</h3>
      <ul>
        {% for r in roots %}
          <li><a href="{{ url_for('view_document', doc_id=r.id) }}">{{ r.title }}</a> · <small>{{ r.created_at.strftime('%Y-%m-%d %H:%M') }}</small></li>
        {% else %}<li>문서가 없습니다.</li>{% endfor %}
      </ul>
    </div>
  </div>
</div>
{% endblock %}
