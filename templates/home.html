{% extends "base.html" %}{% block content %}
<div class="toolbar">
  <a class="btn" href="{{ url_for('index') }}">문서 목록</a>
  {% if g.user %}<a class="btn" href="{{ url_for('create_document') }}">문서 만들기</a>{% endif %}
  {% if g.user %}<a class="btn" href="{{ url_for('logs') }}">로그 보기</a>{% endif %}
</div>
<h2>홈</h2>
<div class="tree">
{% macro render_node(n) -%}
  <li>
    <a href="{{ url_for('view_document', doc_id=n.id) }}">{{ n.title }}</a>
    {% set kids = n.children.order_by(doc_model.created_at.desc()).all() %}
    {% if kids %}<ul>{% for c in kids %}{{ render_node(c) }}{% endfor %}</ul>{% endif %}
  </li>
{%- endmacro %}
<ul>
  {% for r in roots %}{{ render_node(r) }}{% endfor %}
</ul>
</div>
{% endblock %}