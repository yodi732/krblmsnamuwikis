{% extends "base.html" %}
{% block content %}
  <h2>{{ '문서 수정' if doc else '문서 만들기' }}</h2>
  {% if not current_user.is_authenticated %}
    <div class="flash">로그인 후 이용하세요.</div>
  {% elif not current_user.email_verified %}
    <div class="flash">이메일 인증 후 이용하세요. 받은편지함을 확인하거나 <a href="{{ url_for('resend_verification') }}">인증 메일 다시 보내기</a>.</div>
  {% endif %}
  <form method="post">
    <div class="row">
      <div>
        <label>제목</label>
        <input name="title" required value="{{ (doc.title if doc else '')|e }}">
      </div>
      <div>
        <label>상위 문서</label>
        <select name="parent_id">
          <option value="">(없음)</option>
          {% for p in parents %}
            <option value="{{ p.id }}" {% if doc and doc.parent_id==p.id %}selected{% endif %}>{{ p.title }}</option>
          {% endfor %}
        </select>
      </div>
    </div>
    <div>
      <label>내용</label>
      <textarea name="content" rows="10">{{ (doc.content if doc else '')|e }}</textarea>
    </div>
    <div style="margin-top:12px;display:flex;gap:8px">
      <button class="btn btn-primary" type="submit">저장</button>
      <a class="btn" href="{{ url_for('index') }}">취소</a>
    </div>
  </form>
{% endblock %}
