
{% extends "base.html" %}
{% block content %}
  <h2>문서 목록</h2>
  <div class="cards">
    {% for doc in top_docs %}
      <div class="card">
        <div class="head">
          <a href="{{ url_for('doc_detail', doc_id=doc.id) }}">{{ doc.title }}</a>
          <div class="flex">
            <span class="small">{{ doc.updated_at.date() }}</span>
            {% if user %}
            <form action="{{ url_for('doc_delete', doc_id=doc.id) }}" method="post" onsubmit="return confirmDelete(this,'{{doc.title}}');">
              <button class="confirm-btn" type="submit">삭제</button>
            </form>
            {% endif %}
          </div>
        </div>
        <div class="body small">
          {% if not doc.children %}
            하위 문서 없음
          {% else %}
            {% for child in doc.children|sort(attribute='updated_at', reverse=True) %}
              <div class="list-row">
                <div><a href="{{ url_for('doc_detail', doc_id=child.id) }}">{{ child.title }}</a></div>
                <div class="small">{{ child.updated_at.date() }}{% if user %}
                  <form style="display:inline" action="{{ url_for('doc_delete', doc_id=child.id) }}" method="post" onsubmit="return confirmDelete(this,'{{child.title}}');">
                    <button class="confirm-btn" type="submit">삭제</button>
                  </form>
                {% endif %}</div>
              </div>
            {% endfor %}
          {% endif %}
        </div>
      </div>
    {% endfor %}
  </div>
{% endblock %}
