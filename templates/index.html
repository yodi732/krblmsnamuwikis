{% extends "_base.html" %}
{% block content %}
  <h1>문서 목록</h1>
  <div class="list">
    {% for d in parents %}
      <div class="doc-row">
        <div class="doc-title">{{ d.title }}</div>
        <div class="doc-meta">작성 {{ d.created_at.strftime('%Y-%m-%d %H:%M') if d.created_at else '-' }} · 작성자 {{ d.author_email or '알 수 없음' }}</div>
        <div class="row-right">
          {% if current_user.is_authenticated %}
            <a class="btn" href="{{ url_for('edit', doc_id=d.id) }}">수정</a>
            <form method="post" action="{{ url_for('delete', doc_id=d.id) }}" onsubmit="return confirm('삭제할까요?')">
              <button class="btn" type="submit">삭제</button>
            </form>
          {% endif %}
        </div>
      </div>
      {% for c in children.get(d.id, []) %}
        <div class="doc-row child">
          <div class="doc-title">↳ {{ c.title }}</div>
          <div class="doc-meta">작성 {{ c.created_at.strftime('%Y-%m-%d %H:%M') if c.created_at else '-' }} · 작성자 {{ c.author_email or '알 수 없음' }}</div>
          <div class="row-right">
            {% if current_user.is_authenticated %}
              <a class="btn" href="{{ url_for('edit', doc_id=c.id) }}">수정</a>
              <form method="post" action="{{ url_for('delete', doc_id=c.id) }}" onsubmit="return confirm('삭제할까요?')">
                <button class="btn" type="submit">삭제</button>
              </form>
            {% endif %}
          </div>
        </div>
      {% endfor %}
    {% else %}
      <div class="doc-row"><div>아직 문서가 없습니다.</div></div>
    {% endfor %}
  </div>
{% endblock %}
