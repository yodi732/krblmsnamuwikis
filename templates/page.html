{% extends "base.html" %}
{% block title %}{{ page['title'] }} - School Wiki{% endblock %}
{% block content %}
<h2>{{ page['title'] }}</h2>
{% if page['updated_at'] %}<div class="meta">업데이트: {{ page['updated_at'] }}</div>{% endif %}
<div style="white-space:pre-wrap; margin: 12px 0 20px;">{{ page['content'] }}</div>

<p>
  <a class="btn" href="{{ url_for('edit_page', page_id=page['id']) }}">수정</a>
  <a class="btn" href="{{ url_for('page_logs', page_id=page['id']) }}">로그</a>
  <a class="btn" href="{{ url_for('new_page') }}?parent={{ page['id'] }}">하위 문서 만들기</a>
</p>

{% if children %}
  <h3>하위 문서</h3>
  <ul>
  {% for c in children %}
    <li><a href="{{ url_for('view_page', page_id=c['id']) }}">{{ c['title'] }}</a></li>
  {% endfor %}
  </ul>
{% endif %}

<form method="post" action="{{ url_for('delete_page', page_id=page['id']) }}" onsubmit="return confirm('정말 삭제할까요? 하위 문서가 있으면 삭제할 수 없습니다.');">
  <input type="text" name="author" placeholder="작성자(삭제 기록용)">
  <input type="text" name="summary" placeholder="삭제 이유(선택)">
  <button class="btn" type="submit">삭제</button>
</form>
{% endblock %}
