{% extends "base.html" %}
{% block content %}
<h1>문서 만들기</h1>

<form method="post" class="card">
  <div class="row">
    <label>문서 종류</label>
    <div class="row-inline">
      <label class="radio">
        <input type="radio" name="mode" value="parent" checked> 상위문서
      </label>
      <label class="radio">
        <input type="radio" name="mode" value="child"> 하위문서
      </label>
    </div>
  </div>

  <div class="row" id="parentRow" style="display:none;">
    <label>상위 문서 선택</label>
    <select name="parent_id">
      <option value="">-- 선택 --</option>
      {% for p in parents %}
        <option value="{{ p.id }}">{{ p.title }}</option>
      {% endfor %}
    </select>
    <div class="hint">하위의 하위문서는 만들 수 없습니다.</div>
  </div>

  <div class="row">
    <label>제목</label>
    <input type="text" name="title" required>
  </div>

  <div class="row">
    <label>내용</label>
    <textarea name="content" rows="10"></textarea>
  </div>

  <div class="form-actions">
    <button class="btn primary" type="submit">저장</button>
    <a class="btn" href="{{ url_for('index') }}">취소</a>
  </div>
</form>

<script>
const radios = document.querySelectorAll('input[name="mode"]');
const parentRow = document.getElementById('parentRow');
function toggleParent() {
  const v = document.querySelector('input[name="mode"]:checked').value;
  parentRow.style.display = (v === 'child') ? '' : 'none';
}
radios.forEach(r => r.addEventListener('change', toggleParent));
toggleParent();
</script>
{% endblock %}
