
{% extends "base.html" %}
{% block content %}
<h2>새 문서 만들기</h2>

<form method="post" class="form">
  <label>제목</label>
  <input name="title" class="input" placeholder="문서 제목" required>

  <label>내용</label>
  <textarea name="content" class="textarea" placeholder="문서 내용을 입력하세요. (마크다운/텍스트)"></textarea>

  <fieldset class="mt">
    <legend>문서 유형</legend>
    <label><input type="radio" name="doc_type" value="parent" checked> 상위 문서</label>
    <label class="ml-3"><input type="radio" name="doc_type" value="child"> 하위 문서</label>
    <select name="parent_id" id="parent_id" disabled required class="select ml-2">
      <option value="">상위 문서 선택</option>
      {% for p in parents %}
      <option value="{{ p.id }}">{{ p.title }}</option>
      {% endfor %}
    </select>
  </fieldset>

  <button class="btn btn-primary mt">만들기</button>
</form>

<hr class="my-6">

<h3>현재 상위 문서</h3>
{% include "_doc_list.html" %}

<script>
const radios = document.querySelectorAll('input[name="doc_type"]');
const sel = document.getElementById('parent_id');
radios.forEach(r => r.addEventListener('change', () => {
  const isChild = document.querySelector('input[name="doc_type"]:checked').value === 'child';
  sel.disabled = !isChild;
  if (!isChild) sel.value = "";
}));
</script>
{% endblock %}
